import pywhatkit as kit
import time
import pyautogui

# üì± Lista de n√∫meros de los estudiantes
numbers = [
    '573507941614',
    '573232861695',
    '573103554517',
    '573126742590',
    '573207951116',
    '573194999413',
    '573123173384',
    '573176302487',
    '573108285714',
    '573114348704',
    '573247390646',
    '573215056359',
    '573168821775',
    '573167704215',
    '573238742555',
    '573022258321',
    '573135910678',
    '573227685376',
    '573028529815',
    '573215088887',
    '573001777933',
    '573018084247',
    '573104407192',
    '573160891403',
    '573168014813',
    '573186818123',
    '573171532997',
    '573127690744',
    '573128809230',
    '573181579328',
    '573042971622',
    '573186818123',
    '573183387479',
    '573186094669',
    '573162693836',
    '573011680634',
    '573112395655',
    '573218482857',
    '573113857937',
    '573245966697',
    '573167668372',
    '573167385923',
    '573104871354',
    '573151873261',
    '573008519592',
    '573157575155',
    '573044002945',
    '573242452515',
    '573026426483',
    '573183257296',
    '573135392091',
    '573174128633',
    '573154387290',
    '573189000633',
    '573206114894',
    '573023091788',
    '573172709686',
    '573235815766',
    '573163967173',
    '573212204737',
    '573164076714',
    '573225725131',
    '573152930003',
    '573145228321',
    '573113268814',
    '573216270597',
    '573112110949',
    '573188761053',
    '573168331978',
    '573116751272',
    '573508154219',
    '573113600622',
    '573016415387',
    '573226746505',
    '5731505660112',
    '573158080792',
    '573208405971',
    '573108211156',
    '573113536195',
    '573113816830',
    '573166393234',
    '573170755270',
    '573142333145',
    '573182058686',
    '573174894972',
    '573185770428',
    '573054526318',
    '573217937990',
    '573206743619',
    '573186869556',
    '573193846050',
    '573226362237',
    '573168883359',
    '573235758218',
    '573188602999',
    '573244910737',
    '573022244931',
    '573108451742',
    '573128335422',
    '573134840633',
    '573175803723',
    '573247425608',
    '573217139050',
    '573169402225',
    '573117677032',
    '573215239686',
    '573174863787',
    '573218961968',
    '573138247692',
    '573234522959',
    '573105478274',
    '573188822806',
    '573217237696',
    '573160689711',
    '573157103166',
    '573218961968',
    '573138247692',
    '573180429042',
    '573157103166',
    '573161486392',
    '573126041933',
    '573168376980',
    '573135597085',
    '573166515537',
    '573103899431',
    '573012732242',
    '573158484096',
    '573137438013',
    '573178726865',
    '573182016620',
    '573157076125',
    '573234812244',
    '573158259607',
    '573157918305',
    '573126707729',
    '573205268597',
    '573156554802',
    '573005324102',
    '573172538724',
    '573183296874',
    '573232975515',
    '573137010715',
    '573174834323',
    '573016982523',
    '573128479229',
    '573249223249',
    '573054764094',
]

# üí¨ Mensaje
mensaje = (
    "Hola queridos estudiantes interesados en el curso de inyectolog√≠a.\n\n"
    "Recuerden que se llevar√° a cabo el 8 y 15 de Nov. De 1pm a 5pm.\n\n"
    "Por un valor de $100.000, que deben estar pagos para separar tu cupo el 4 de Noviembre.\n\n"
    "Cupos limitados, no te quedes sin el tuyo.\n\n"
    "Realiza tu pago al n√∫mero de cuenta habitual y env√≠a el comprobante aqu√≠ con tu nombre completo.\n\n"
    "Comun√≠cate: 302 5270747"
)

# ‚è∞ Tiempo de espera despu√©s de abrir WhatsApp Web
tiempo_espera = 15  # segundos

print("Abre WhatsApp Web en tu navegador antes de continuar.\n")
time.sleep(5)

for i, numero in enumerate(numbers, 1):
    phone = f"+{numero}"
    print(f"[{i}/{len(numbers)}] Enviando mensaje a {phone}...")
    try:
        # Abre WhatsApp y espera
        kit.sendwhatmsg_instantly(phone, mensaje, wait_time=20, tab_close=True)
        print(f"Esperando {tiempo_espera} segundos para que cargue WhatsApp Web...")
        time.sleep(tiempo_espera)

        # Presiona ENTER para enviar el mensaje
        pyautogui.press("enter")

        print(f"[OK] Mensaje enviado correctamente a {phone}\n")
        time.sleep(5)  # espera antes de pasar al siguiente n√∫mero

    except Exception as e:
        print(f"[ERROR] No se pudo enviar el mensaje a {phone}: {e}\n")
        time.sleep(3)

print("‚úÖ Proceso completado. Todos los mensajes fueron enviados o intentados.")
